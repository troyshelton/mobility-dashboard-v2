select o.order_id from orders o, order_ingredient oi, med_admin_event m plan o where o.person_id = trigger_personid and o.catalog_type_cd = value(uar_get_code_by("DISPLAYKEY",6000,"PHARMACY")) and o.activity_type_cd = value(uar_get_code_by("DISPLAYKEY",106,"PHARMACY")) and o.orig_order_dt_tm between cnvtlookbehind("1,Y",cnvtdatetime(curdate,0)) and cnvtdatetime(curdate,235959) and o.order_status_cd != value(uar_get_code_by("DISPLAYKEY",6004,"VOIDED")) and o.iv_ind = 1 and o.template_order_id = 0.00 join oi where oi.order_id = o.order_id and oi.catalog_cd =  value(uar_get_code_by("DISPLAYKEY",200,"EPOPROSTENOL")) and oi.ingredient_type_flag = 3.00 and oi.action_sequence = (select max(oi2.action_sequence) from order_ingredient oi2 where oi2.order_id = o.order_id and oi2.ingredient_type_flag = 3.00) join m where m.order_id = o.order_id and m.event_type_cd = value(uar_get_code_by("DISPLAYKEY",4000040,"ADMINISTERED")) order by o.order_id head report log_message = "ORDER NOT FOUND" log_misc1 = cnvtstring(0) is_found = 0 head o.order_id if(is_found = 0) log_message = "ORDER FOUND" log_misc1 = cnvtstring(o.order_id) endif is_found = 1 with nocounter, time = 60, nullreport go





select od.oe_field_display_value from orders o, order_detail od plan o where o.order_id = @MISC:6 join od where od.order_id = o.order_id and od.oe_field_meaning_id in (99.0, 100.0) order by od.detail_sequence head report log_message = "WEIGHT NOT FOUND" log_misc1 = "WEIGHT NOT FOUND" detail if(od.oe_field_meaning_id = 99.0) log_misc1 = trim(od.oe_field_display_value,3) elseif(od.oe_field_meaning_id = 100.0) log_misc1 = build2(log_misc1," ",trim(od.oe_field_display_value,3)) endif foot report log_message = "WEIGHT FOUND" with nocounter, time = 60, nullreport go